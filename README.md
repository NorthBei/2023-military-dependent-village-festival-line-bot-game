# 2023新北市眷村文化節 - 轉生遇見你 - LINE Bot闖關遊戲
![image](https://github.com/NorthBei/2023-military-dependent-village-festival/assets/15665709/a4759fca-8aa3-4e9e-88a1-7a850f5edf68)

## Project Intro

https://github.com/NorthBei/2023-military-dependent-village-festival/assets/15665709/29974c1f-32dd-48fc-bb1a-acf40169f92c

跟著主視覺動畫，一起轉～生～去</br>
─=≡Σ((( つ•̀ω•́)つ ▸▸［ 轉生 ★ 遇眷你 ］</br>
　　​
空軍三重一村，首款開村大作！</br>
　　​
透過 LINE 與你的專屬夥伴「轉轉獸」</br>
在時空穿越的村子中解謎、闖關、進化</br>
並享受一系列的音樂、戲劇、書籍與展演吧！</br>
　　​
☛ 準 備 好 登 入 新 北 市 眷 村 文 化 節？</br>
　　​</br>
　　　 ▸▸​［ 創 建 帳 號 ］</br>
　　　 　［ 繼 續 遊 戲 ］</br>



![image](https://github.com/NorthBei/2023-military-dependent-village-festival/assets/15665709/4dd6652a-5bb8-4306-8fbc-4cb6cf38884e)
「2023新北市眷村文化節」即日起至29日在空軍三重一村舉行，以「轉生遇眷你」為主題，象徵眷村文化世代融合，規劃假日市集、小旅行、主題講座等系列活動，透過展覽體會眷村生活與演變，讓民眾深度認識眷村文化。

![image](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/9fdb7b1b-53c2-4bdc-80a2-7f9a1c995373)
登入遊戲第一步，馬上捕獲一隻專屬的轉轉獸 👾</br>
命運安排隨機獲得，好想遇眷！

![image](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/d475af29-bfaf-421e-b694-acefd56b3ac3)
破關只需要按LINE機器人提示，輸入答案就可以獲得麻將點數</br>
一起來收集麻將，湊滿大四喜（？





### Person In charge
- Plan by [滾出趣創意生活有限公司](https://rollinginlife.tw/)
- Design by 皮皮
- Website Dev by NorthBei from [Metartemis](https://metartemis.co)


### Relative Link
- [滾出趣Rolling in Life Facebook Post](https://www.facebook.com/photo/?fbid=707243368110216&set=pcb.707243548110198)
- [「轉生遇眷你」 傳遞跨時代記憶](https://tw.news.yahoo.com/%E8%BD%89%E7%94%9F%E9%81%87%E7%9C%B7%E4%BD%A0-%E5%82%B3%E9%81%9E%E8%B7%A8%E6%99%82%E4%BB%A3%E8%A8%98%E6%86%B6-160000348.html)
- [新北市政府 - 市政新聞 - 2023新北市眷村文化節 「轉生遇見你」 中秋走進1950到Y2K回憶漩渦](https://www.ntpc.gov.tw/ch/home.jsp?id=e8ca970cde5c00e1&dataserno=6ed5edf1e724b7d264a88613144b6d39)
- [時藝 - 2023 新北市眷村文化節 轉生 ★ 遇眷你](https://mediasphere.com.tw/events/44)

### Screenshots/Film

**遊戲開始、抽轉轉獸&命運機會**

https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/23395cb7-6a73-4c8a-8885-a3cac7ec38f5


**解謎遊戲，猜對就能夠取得麻將**

https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/049729c9-e3c3-4763-8ef1-41cd6a43781b


**解謎遊戲，猜對就能夠取得麻將、抽命運機會**

https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/1148460f-0f16-48f7-9690-4decf7e8b739


**遊戲尚未開始**
|A|B|C|D|
|-|-|-|-|
|![Screenshot_20230930-130939](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/441ccb11-a7c2-42f9-813f-c8ae0b0f8531)|![Screenshot_20230930-131654](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/cc109e48-2918-4de9-bc34-d528c31fba95)|![Screenshot_20230930-131703](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/cd8e7bb7-d976-4e68-9a2a-0bb7ab11fa46)|![Screenshot_20230930-131709](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/08c35c1d-0f49-4a4f-9a07-e2eafb20733b)|


**遊戲開始，取得轉轉獸**
|A|B|C|D|
|-|-|-|-|
|![Screenshot_20230930-165254](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/8d001141-5c15-4a7b-8c3e-6dd66aad74c9)|![Screenshot_20230930-165257](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/f2556dfa-814b-4238-91d3-5a0cd2381bab)|![Screenshot_20230930-165300](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/c3a28082-5c2f-455a-8f9d-3d56a7636ef5)|![Screenshot_20230930-165302](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/c0b449be-4a38-47cd-8d19-68093971bcea)|
|![Screenshot_20230930-165304](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/bf4633e3-91a8-432d-9b81-6743bf73a513)|![Screenshot_20230930-165314](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/63033ad1-3f38-4acb-8b57-94e16c162832)|![Screenshot_20230930-165318](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/184a6e8f-1fb1-4de0-bbf0-094af6d04e73)|![Screenshot_20230930-165337](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/80b51143-96f1-45a3-a1b5-1386ecf12e62)|
|![Screenshot_20230930-165343](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/b06ff181-d34d-4759-9485-fe949b0515aa)|![Screenshot_20230930-165350](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/15b9da82-dbb1-47d6-92b9-be4ec02b3fb6)|![Screenshot_20230930-165427](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/4bafa9c5-3213-453c-911e-aa244707ef6a)|![Screenshot_20230930-165430](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/36413d61-8944-4282-a1c1-d5e0c2b610fa)|

**遊戲進行中，解謎取得麻將&兌換禮物**
|A|B|C|D|
|-|-|-|-|
|![Screenshot_20230930-170603](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/e6169010-35b9-4d26-bc4d-af0101e25ca2)|![Screenshot_20230930-170600](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/62f76f05-955f-4bef-a59c-5fcfe975edbe)|![Screenshot_20240203-082531](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/e7288463-0c37-4199-ad58-5fe1ca2cfe4e)|![Screenshot_20240203-082636](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/aeb3e7aa-7074-473b-a3cf-b5d5d10c60fe)|


**遊戲進行中，遊戲廣播**
|A|B|C|D|
|-|-|-|-|
|![Screenshot_20230930-133226](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/5c525573-d6db-4f8b-a98f-ca991820d878)|![Screenshot_20230930-165232](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/95da74b9-dfbb-4126-b85e-11bae52876d8)|![Screenshot_20230930-165241](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/76d831ad-9fb3-49d3-96f4-b025dcd87200)|![Screenshot_20230930-165245](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/96b95e43-22b3-41f3-bb38-eaf43865f772)|


**遊戲結束，珍～重～再～眷～**
|A|B|C|
|-|-|-|
|![Screenshot_20230930-223251](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/8e4d9949-a9b9-4ef3-9fa1-cafad4c94e30)|![Screenshot_20230930-223300](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/c5bf8569-dd54-4abc-bc2d-370fb9501373)|![Screenshot_20230930-223317](https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/dd3720d8-9272-453b-b717-5a78c4715392)|



## Web/Chatbot Development Instruction

### Environment

|Service|Version|
|-|-|
|Node.js|v18.18.2|
|npm| v9.8.1|

### Environment Variables

Rename the `.env.local.example` to `.env.beta.local`, `.env.production.local` , and get the env var from Google Analytics / LINE developer console / Firebase service

|Service|Env var|Note|
|-|-|-|
|Firebase|NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||
|Firebase|NEXT_PUBLIC_FIREBASE_PROJECT_ID||
|Firebase|NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||
|Firebase|NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID||
|Firebase|NEXT_PUBLIC_FIREBASE_APP_ID||
|Firebase|FIREBASE_SERVICE_ACCOUNT_JSON| service account JSON String `{"type":"service_account","project_id":...}`|
|LINE LIFF|NEXT_PUBLIC_LIFF_ID||
|LINE Messaging Api|LINE_MESSAGING_API_ACCESS_TOKEN||
|LINE Messaging Api|LINE_MESSAGING_API_CHANNEL_SECRET||
|Domain|The service domain|default `https://game.seeyouinvillage-ntpc.xyz`|
|Google Analytics|NEXT_PUBLIC_GA_MEASUREMENT_ID|GA ID, won't set in beta|

### Getting Started

Install packages & Run the development server:

```zsh
npm run install
npm run build
npm run dev
```

Note: you should run `build` before run `dev` at first time you run `dev`, or you will see below error message
<img width="1274" alt="image" src="https://github.com/NorthBei/2023-military-dependent-village-festival-line-bot-game/assets/15665709/f32b1986-9302-44f7-a5bd-e6836c30fc0d">


### Project setup

Install all packages
```zsh
npm run install
npm run build
```

### Start Development

Run custom development web server at http://localhost:3200 for development

```zsh
npm run dev // equal to npm run serve --env=beta
```

### Lint all files

Run lint for all files with eslint

```zsh
npm run lint
```

### Build Production

Run below command to build this project with Next.js.

```zsh
npm run build --env=beta
npm run build --env=production
```

### Service Preview

Run local server for running service at http://localhost:3200

```zsh
npm run serve --env=beta
npm run serve --env=production
```

### Start service in Heroku clould

Run node.js service by this command in Heroku with pre-set environment variable

```zsh
npm run start:js
```

## Functions Development Instruction

### Environment

|Service|Version|
|-|-|
|Node.js|v18.18.2|
|npm| v9.8.1|

### Environment Variables

Rename the `.env.example` to `.env.beta`, `.env.prod` , and get the env var from LINE developer console service

|Service|Env var|Note|
|-|-|-|
|LINE Messaging Api|LINE_MESSAGING_API_ACCESS_TOKEN||
|LINE Messaging Api|LINE_MESSAGING_API_CHANNEL_SECRET||
|Domain|The service domain|default `https://game.seeyouinvillage-ntpc.xyz`|

### Getting Started

Install packages & Run the development server:

```zsh
npm run install
firebase use beta
npm run serve
```

### Project setup

Install all packages
```zsh
npm run install
```

### Start Development

Run custom development server at http://localhost:5001 for development

```zsh
npm run serve
```

or run one of below command to start firebase functions shell to interact with functions

```zsh
npm run start // equal to npm run shell --env=prod
npm run shell --env=beta
npm run shell --env=prod
```

### Lint all files

Run lint for all files with eslint

```zsh
npm run lint
```

### Build Production

Run below command to build functions from ts to js

```zsh
npm run build
```

### Service Preview

Run functions at http://localhost:5001 with firebase emulator

```zsh
npm run serve
```

### Service Deploy

Deploy functions to Firebase Cloud Functions

```zsh
npm run deploy --env=beta
npm run deploy --env=production
```

## Reference
- Next.js
  - [Custom NextJS Server with Typescript](https://dev.to/deiucanta/custom-nextjs-server-with-typescript-3mdb)
  - [[Next.js 13.3.0] Upgrade breaks @svgr/webpack in appDir](https://github.com/vercel/next.js/issues/48177)
- Firebase
  - [Using Firestore With Typescript](https://medium.com/swlh/using-firestore-with-typescript-65bd2a602945)
  - [利用 Firebase Auth 整合 Line 第三方登入](https://ithelp.ithome.com.tw/articles/10312761)
- Typescript
  - [How to Import a JSON file in Typescript](https://reacthustle.com/blog/how-to-import-a-json-file-in-typescript)
